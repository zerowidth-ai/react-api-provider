{"version":3,"file":"index.js","sources":["../../src/index.js"],"sourcesContent":["import React, { createContext, useState, useContext, useCallback } from 'react';\n\nconst ZeroWidthApiContext = createContext();\n\nconst generateId = () => `id_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n\nexport const ZeroWidthApiProvider = ({ children, appId, endpointId, proxyUrl, debugMode }) => {\n  if(debugMode) console.log('ZeroWidthApiProvider', { appId, endpointId, proxyUrl, debugMode });\n\n  const effectiveEndpointId = endpointId || appId;\n  if (appId) {\n    console.warn('Warning: The appId prop is deprecated and will be removed in future versions. Please use endpointId instead.');\n  }\n\n  if (!effectiveEndpointId || typeof effectiveEndpointId !== 'string' || typeof proxyUrl !== 'string') {\n    throw new Error('endpointId (or appId for backward compatibility) and proxyUrl props must be provided as strings to ZeroWidthApiProvider');\n  }\n\n  const [data, setData] = useState({});\n  const [error, setError] = useState({});\n  const [loading, setLoading] = useState({});\n\n  const process = useCallback(async (options = {}, identifier = generateId()) => {\n    setLoading(prev => ({ ...prev, [identifier]: true }));\n    setError(prev => ({ ...prev, [identifier]: null }));\n\n    try {\n      const url = `${proxyUrl}/process/${effectiveEndpointId}/${options.agentId}`;\n      const response = await fetch(url, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(options)\n      });\n      const responseData = await response.json();\n      setData(prev => ({ ...prev, [identifier]: responseData }));\n    } catch (err) {\n      setError(prev => ({ ...prev, [identifier]: err }));\n    } finally {\n      setLoading(prev => ({ ...prev, [identifier]: false }));\n    }\n  }, [proxyUrl, effectiveEndpointId]);\n\n  const getHistory = useCallback(async ({ agentId, userId, sessionId, startAfter } = {}, identifier = generateId()) => {\n    setLoading(prev => ({ ...prev, [identifier]: true }));\n    setError(prev => ({ ...prev, [identifier]: null }));\n\n    try {\n      const queryParams = new URLSearchParams(startAfter ? { startAfter } : {});\n      const response = await fetch(`${proxyUrl}/history/${effectiveEndpointId}/${agentId}/${userId}/${sessionId}?${queryParams}`);\n      const responseData = await response.json();\n      setData(prev => ({ ...prev, [identifier]: responseData }));\n    } catch (err) {\n      setError(prev => ({ ...prev, [identifier]: err }));\n    } finally {\n      setLoading(prev => ({ ...prev, [identifier]: false }));\n    }\n  }, [proxyUrl, effectiveEndpointId]);\n\n  return (\n    <ZeroWidthApiContext.Provider value={{ data, error, loading, process, getHistory }}>\n      {children}\n    </ZeroWidthApiContext.Provider>\n  );\n};\n\nexport const useZeroWidthApi = () => {\n  const context = useContext(ZeroWidthApiContext);\n  if (context === undefined) {\n    throw new Error('useZeroWidthApi must be used within a ZeroWidthApiProvider');\n  }\n  return context;\n};\n"],"names":["ZeroWidthApiContext","createContext","generateId","concat","Date","now","Math","random","toString","substr","ZeroWidthApiProvider","_ref","children","appId","endpointId","proxyUrl","debugMode","console","log","effectiveEndpointId","warn","Error","_useState2","_slicedToArray","useState","data","setData","_useState4","error","setError","_useState6","loading","setLoading","process","useCallback","_asyncToGenerator","_regeneratorRuntime","mark","_callee","options","identifier","url","response","responseData","_args","arguments","wrap","_context","prev","next","length","undefined","_objectSpread","_defineProperty","agentId","fetch","method","headers","body","JSON","stringify","sent","json","t0","finish","stop","getHistory","_callee2","_ref4","userId","sessionId","startAfter","queryParams","_args2","_context2","URLSearchParams","React","createElement","Provider","value","useZeroWidthApi","context","useContext"],"mappings":"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"}